<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>Vastness: Memory of Color</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=K2D:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=K2D:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Rambla:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <script type="module" src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css" />
    <link rel="stylesheet"href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <link rel="stylesheet" href="https://js.arcgis.com/4.31/esri/themes/light/main.css" />
    <script src="https://js.arcgis.com/4.31/"></script>
 <style>
    html,
    body,
    #viewDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;      
    }

    ion-split-pane {
      --side-width: 50%;
      --side-max-width: 50%;
      --border: none;
    }

   #mapbar {
      --background: none; /* Remove default background */
      background: linear-gradient(90deg, rgba(146,190,240,1) 23%, rgba(60,113,186,1) 48%, rgba(89,139,207,1) 73%);
    }

    #swiperbar {
      --background: none; /* Remove default background */
      background: #598bcf;
    }
      
    .splash-screen {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
       background-image: url("images/background.jpg");
       background-size: cover;
    
      color: white;
      font-family: 'K2D', serif;
      animation: fadeOut 2s ease forwards;
      animation-delay: 5s;

    }
    .title {
      font-size: 4rem;
      white-space: nowrap;
      overflow: hidden;
      display: inline-block;
      letter-spacing: 3px;
      animation: windEffect 3s ease forwards;
    }
    .subtitle {  
      font-family: 'Rambla', serif;    
      font-size: 2rem;
      margin-top: 1rem;
      opacity: 0;
      animation: fadeIn 2s ease forwards;
      animation-delay: 3s;
    }

    @keyframes windEffect {
      0% {
        transform: translateX(-100%);
        opacity: 0;
      }
      50% {
        opacity: 1;
      }
      100% {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes fadeOut {
      from {
        opacity: 1;
      }
      to {
        opacity: 0;
      }
    }

    .main-content {
      display: block;
    }

    #caption {
      position: fixed;
      top: 0;
      margin-left: 20px;
       justify-content: center;
      align-items: center;
      font-family: 'Rambla', serif;    
      font-size: 2rem;
      font-style: italic;
      margin-top: 1rem;
      opacity: 0;
      animation: fadeIn 2s ease forwards;
      animation-delay: 3s;
    }

    #date {
      font-family: 'Rambla', serif;
      position: fixed;
      top: 10;
      left: 30px;
    }

    #openModal {
      --background: none !important;
    }

    #modalBar {
      --background:linear-gradient(90deg, rgba(146,190,240,1) 23%, rgba(60,113,186,1) 48%, rgba(89,139,207,1) 73%);    }

      /* Custom CSS for round zoom controls */
        .esri-widget {
          background-color: rgba(0,0,0,0) !important;
          box-shadow: 0 2px 4px rgba(0,0,0,0) !important;
        }

        .esri-widget--button {
          background-color: none; /* Set background color */          
          border-radius: 100%; /* Make them round */
          width: 50px; /* Width of the button */
          height: 50px; /* Height of the button */
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Add shadow */
          margin: 10px; /* Margin between buttons */
          padding: 0;
        }

        .esri-widget--button .esri-icon {
            margin: 0; /* Center the icon */
            font-size: 40px; /* Size of the icon */
            font-weight: 700;
            color: #0079c1; /* Icon color */
        }

       .esri-view .esri-view-surface--touch-none:focus::after {
          outline: none !important;
        }

    </style>
  </head>
  <body> 

      <ion-modal trigger="open-modal">
    <ion-header>
      <ion-toolbar id="modalBar">        
        <ion-title style="font-family: 'Rambla', serif;">About this Project</ion-title>
        <ion-buttons slot="end">
          <ion-button strong="true" id="close">X</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding">
      <img
  src="images/library.jpg"
  alt="Vastness exhibit in the Opie Reading Room of the Library"
></img>
      <ion-text style="font-family: 'Rambla', serif;"><h3>About</h3></ion-text>
      <ion-text>
        <p>Vastness: Memory of Color is a collaboration initiated by Anne Beffel. Beginning with her photographs of Lake Superior, Sound Designers Aidan Conrade, Jayden Palarz, and Tom Stiles interpreted the images using audio. Angie Gecosky assisted with video editing and coordinated production. Our goal was to create a meditative experience (loosely defined) for viewer- participants. </p>   
        <p>The photographs are based on Beffelâ€™s observations of the relationship between vision and our daily lives. How we see influences us just as much as what we see. Visual perception is a fluid process of translating color and shape into images. These images enable us to come closer to a shared experience, even as we view the world from different subject positions.</p> 
        
      </ion-text> 
        <ion-text style="font-family: 'Rambla', serif;"><h3>Using the Application</h3></ion-text>
        <ion-text><p>Swipe left or right or press the left or right arrows to view photographs. The map will automatically update with a corresponding location of where each photograph was taken.</p></ion-text> 
        <ion-text>To listen to the sounds from the exhibit, scan the QR code below.</ion-text>
        <img src="images/qr.png"></img>        
    </ion-content>
  </ion-modal>
<div class="main-content" id="content">
  <ion-split-pane when="xs" content-id="main">
  <ion-menu content-id="main">
    <ion-header>
      <ion-toolbar id="mapbar">
         <ion-buttons slot="start">
            <ion-button text="HOME" icon="home-outline" style="color:white;" onclick="window.open('https://mtu-vpol.github.io/kiosk','_self')"><ion-icon name="caret-back"></ion-icon> MENU</ion-back-button>
          </ion-buttons>     
           <ion-buttons slot="start">
        <ion-img src="images/huskywhite.svg" style="width: 50px; height: 50px;"></ion-img>
      </ion-buttons>    
        <ion-title style="font-family: 'K2D', serif; font-size: 26pt; color:white; letter-spacing: 1px"><b>Vastness:</b> Memory of Color</ion-title>
      </ion-toolbar>
    </ion-header>
     <div id="viewDiv"></div>
  </ion-menu>

  <div class="ion-page" id="main">
    <ion-header>
      <ion-toolbar id="swiperbar">
        <ion-button size="med" slot="end"  id="openModal">
  <ion-icon name="information-circle-outline" size="large" slot="icon-only"></ion-icon>
</ion-button>  
      </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding"> 
      <!-- Slider main container -->
<div class="swiper">
  <!-- Additional required wrapper -->
  <div class="swiper-wrapper">   
  </div>
  <!-- If we need pagination -->
  <div class="swiper-pagination"></div>

  <!-- If we need navigation buttons -->
  <div class="swiper-button-prev"></div>
  <div class="swiper-button-next"></div>

  <!-- If we need scrollbar -->
  <div class="swiper-scrollbar"></div>
</div>

     </ion-content>
  </div>
</ion-split-pane>
</div>

 <div class="splash-screen" id="splash">
    <div class="title">VASTNESS: Memory of Color</div>
    <div class="subtitle">Art, Sounds & Meditation</div>
    
  </div>

  </body>

  <script>

   setTimeout(() => {
     document.getElementById('splash').style.display = 'none';
     document.getElementById('content').style.display = 'block';

   }, 6000); // 3s animation + 1s buffer

   require(["esri/Map", "esri/views/MapView", "esri/layers/FeatureLayer"], (Map, MapView, FeatureLayer) => {

     var modal = document.querySelector('ion-modal'); 
  const map = new Map({
    basemap: "topo-vector"
  });

  const view = new MapView({
    container: "viewDiv",
    map: map,
    center: [-88.0312715, 47.201094],
    zoom: 9
  });

   const simpleMarkerSymbol = {
              type: "simple-marker", // autocasts as new SimpleMarkerSymbol()
              path: "M12 0C5.373 0 0 5.373 0 12C0 22.725 12 36 12 36C12 36 24 22.725 24 12C24 5.373 18.627 0 12 0Z",
              color: "rgba(89,139,207,1)",
              outline: {
                color: "white",
                width: 2
              },
              size: "34px",
            };

            const pin = {
              type: "simple",
              symbol: simpleMarkerSymbol
            };

  const photoLayer = new FeatureLayer({
    url: "https://services2.arcgis.com/RPhrOu9XQzI31xTa/arcgis/rest/services/Vastness_Photograph_Locations/FeatureServer/0",
    outFields: ["Image_No", "Date", "Caption"],
    renderer: pin
  });

  map.add(photoLayer);

  const swiper = new Swiper('.swiper', {
    direction: 'horizontal',
    loop: false,
    pagination: {
      el: '.swiper-pagination',
    },
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    scrollbar: {
      el: '.swiper-scrollbar',
    },
  });

  // Store the highlight handle
  let highlightHandle;

  // Fetch features and populate Swiper slides
  photoLayer.queryFeatures({
    where: "1=1",
    outFields: ["*"],
    returnGeometry: true
  }).then((results) => {
    const features = results.features;
    console.log(features);
    features.forEach((feature, index) => {
      const attributes = feature.attributes;

      // Create Swiper slide
      const slide = document.createElement("div");
      slide.className = "swiper-slide";
      slide.innerHTML = `
        <img src="images/${attributes.Image_No}.jpg" alt="${attributes.Caption}" style="width: 100%; height: auto;">
        <div id="date"><i>Photo taken on ${attributes.Date}</p></i></div>
        <div id="caption"><p>${attributes.Caption}</p></div>
      `;
      slide.dataset.index = index;
      document.querySelector(".swiper-wrapper").appendChild(slide);
    });

    swiper.update();

    view.whenLayerView(photoLayer).then((layerView) => {
          if (highlightHandle) {
            highlightHandle.remove(); // Clear previous highlights
          }

          highlightHandle = layerView.highlight(features[swiper.activeIndex]);

          // Zoom to the feature
          view.goTo({
            center: features[swiper.activeIndex].geometry,
            zoom: 15
          });
        });

    

    // Synchronize Swiper slide change with map
    swiper.on("slideChange", () => {
      const activeIndex = swiper.activeIndex;
      const activeFeature = features[activeIndex];

      if (activeFeature && activeFeature.geometry) {
        // Highlight the feature
        view.whenLayerView(photoLayer).then((layerView) => {
          if (highlightHandle) {
            highlightHandle.remove(); // Clear previous highlights
          }

          highlightHandle = layerView.highlight(activeFeature);

          // Zoom to the feature
          view.goTo({
            center: activeFeature.geometry,
            zoom: 15
          });
        });
      }
    });

    // Handle map clicks to sync with Swiper
    view.on("click", (event) => {
      view.hitTest(event).then((response) => {
        const graphic = response.results.find((result) => result.graphic.layer === photoLayer);
        if (graphic) {
          console.log(graphic);
          const clickedIndex = features.findIndex((f) => f.attributes.Image_No === graphic.graphic.attributes.Image_No);
          swiper.slideTo(clickedIndex);
        }
      });
    });

     $("#openModal").click(function(){
      modal.isOpen = true;
    });

    $("#close").click(function(){
      modal.isOpen = false;
    });
  });
});

  </script>

</html>